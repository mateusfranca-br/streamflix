import { useParams } from 'react-router-dom'
import movies from '../../data/movies.json'
import { useState,useEffect } from 'react'
import { addToList,removeFromList,getList } from '../../utils/localStorage'
import '../../styles/buttons.css'
import './Details.css'
export default function Details(){const {id}=useParams();const movie=movies.find(m=>m.id===Number(id));const [inList,setInList]=useState(false);useEffect(()=>{if(!movie) return; const list=getList(); setInList(list.some(item=>item.id===movie.id));},[movie]); if(!movie) return <div className="main-container"><p>Filme não encontrado</p></div>; const handleToggle=()=>{ if(inList){ removeFromList(movie.id); setInList(false); return } addToList({id:movie.id,title:movie.title,poster:movie.poster,year:movie.year,genre:movie.genre}); setInList(true) }; return (<div className="main-container details-page"><div className="details-top"><div className="poster-block"><img src={movie.poster} alt={movie.title} /></div><div className="info-block"><h1>{movie.title} <small className="year">({movie.year})</small></h1><p className="meta">{movie.genre} {movie.cast ? '• '+ (Array.isArray(movie.cast)?movie.cast.join(', '):movie.cast) : ''}</p><p className="overview">{movie.synopsis || movie.overview || ''}</p><div className="actions"><button className={'nf-btn '+ (inList? 'inlist' : 'add')} onClick={handleToggle}>{inList? '✔ Na Minha Lista' : '+ Adicionar à Minha Lista'}</button><a className="nf-btn secondary" href={movie.trailer || '#'} target="_blank" rel="noreferrer">▶ Assistir Trailer</a></div></div></div>{movie.trailer && (<div className="trailer-embed"><iframe src={movie.trailer} title={movie.title} allowFullScreen frameBorder="0"></iframe></div>)}</div>)}
